<?xml version="1.0" encoding="UTF-8" ?>
<XMLDB PATH="blocks/ifcare/db" VERSION="2024011811" COMMENT="Instalação do banco de dados para o seu plugin" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../lib/xmldb/xmldb.xsd">

  <TABLES>
    <TABLE NAME="ifcare_classe_aeq" COMMENT="Tabela para armazenar as classes do AEQ">
      <FIELDS>
        <FIELD NAME="idclasseaeq" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" AUTO="true" SEQUENCE="true" COMMENT="ID da classe AEQ" />
        <FIELD NAME="nome" TYPE="text" NOTNULL="true" COMMENT="Nome da classe AEQ" />
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="idclasseaeq" />
      </KEYS>
    </TABLE>

    <TABLE NAME="ifcare_emocao" COMMENT="Tabela para armazenar as emoções">
      <FIELDS>
        <FIELD NAME="idemocao" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" AUTO="true" SEQUENCE="true" COMMENT="ID da emoção" />
        <FIELD NAME="nome" TYPE="text" NOTNULL="true" COMMENT="Nome da emoção" />
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="idemocao" />
      </KEYS>
    </TABLE>

    <TABLE NAME="ifcare_momentocoleta" COMMENT="Tabela para armazenar os momentos de coleta">
      <FIELDS>
        <FIELD NAME="idmomento" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" AUTO="true" SEQUENCE="true" COMMENT="ID do momento de coleta" />
        <FIELD NAME="nome" TYPE="text" NOTNULL="true" COMMENT="Nome do momento de coleta" />
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="idmomento" />
      </KEYS>
    </TABLE>

    <TABLE NAME="ifcare_cadastrocoleta" COMMENT="Tabela para armazenar dados de cadastro de coleta">
      <FIELDS>
        <FIELD NAME="idcadastrocoleta" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" AUTO="true" SEQUENCE="true" COMMENT="ID do cadastro de coleta" />
        <FIELD NAME="nome" TYPE="text" NOTNULL="true" COMMENT="Nome do cadastro" />
        <FIELD NAME="datahoraini" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" COMMENT="Data e hora de início" />
        <FIELD NAME="datahorafim" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" COMMENT="Data e hora de fim" />
        <FIELD NAME="descricao" TYPE="text" COMMENT="Descrição do cadastro de coleta" />
        <FIELD NAME="receberalertacoleta" TYPE="int" LENGTH="1" NOTNULL="true" UNSIGNED="true" DEFAULT="0" COMMENT="Receber alerta de coleta" />
        <FIELD NAME="notificaralunocoleta" TYPE="int" LENGTH="1" NOTNULL="true" UNSIGNED="true" DEFAULT="0" COMMENT="Notificar aluno sobre a coleta" />
        <FIELD NAME="idcurso" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" COMMENT="ID do curso" />
        <FIELD NAME="listaidemocoes" TYPE="text" COMMENT="Lista de IDs de emoções" />
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="idcadastrocoleta" />
      </KEYS>
    </TABLE>

    <TABLE NAME="ifcare_perguntas_aeq" COMMENT="Tabela para armazenar perguntas AEQ">
      <FIELDS>
        <FIELD NAME="idperguntaaeq" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" AUTO="true" SEQUENCE="true" COMMENT="ID da pergunta AEQ" />
        <FIELD NAME="descricao" TYPE="text" NOTNULL="true" COMMENT="Descrição da pergunta AEQ" />
        <FIELD NAME="idmomentocoleta" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" COMMENT="ID do momento de coleta" />
        <FIELD NAME="idemocao" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" COMMENT="ID da emoção" />
        <FIELD NAME="idcoleta" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" COMMENT="ID da coleta" />
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="idperguntaaeq" />
        <KEY NAME="fk_momentocoleta" TYPE="foreign" FIELDS="idmomentocoleta" REFTABLE="momentocoleta" REFFIELDS="idmomento" ONDELETE="cascade" />
        <KEY NAME="fk_emocao" TYPE="foreign" FIELDS="idemocao" REFTABLE="emocao" REFFIELDS="idemocao" ONDELETE="cascade" />
        <KEY NAME="fk_coleta" TYPE="foreign" FIELDS="idcoleta" REFTABLE="coleta" REFFIELDS="idcoleta" ONDELETE="cascade" />
      </KEYS>
    </TABLE>

    <TABLE NAME="ifcare_aluno" COMMENT="Tabela para armazenar dados dos alunos">
      <FIELDS>
        <FIELD NAME="idaluno" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" AUTO="true" SEQUENCE="true" COMMENT="ID do aluno" />
        <FIELD NAME="nome" TYPE="text" NOTNULL="true" COMMENT="Nome do aluno" />
        <FIELD NAME="email" TYPE="text" NOTNULL="true" COMMENT="Email do aluno" />
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="idaluno" />
      </KEYS>
    </TABLE>

    <TABLE NAME="ifcare_classe_emocao" COMMENT="Tabela para associar classes AEQ às emoções">
      <FIELDS>
        <FIELD NAME="idclasseaeq" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" COMMENT="ID da classe AEQ" />
        <FIELD NAME="idemocao" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" COMMENT="ID da emoção" />
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="idclasseaeq, idemocao" />
        <KEY NAME="fk_classeaeq" TYPE="foreign" FIELDS="idclasseaeq" REFTABLE="classe_aeq" REFFIELDS="idclasseaeq" ONDELETE="cascade" />
        <KEY NAME="fk_emocao" TYPE="foreign" FIELDS="idemocao" REFTABLE="emocao" REFFIELDS="idemocao" ONDELETE="cascade" />
      </KEYS>
    </TABLE>

    <TABLE NAME="ifcare_coleta" COMMENT="Tabela para armazenar as coletas de emoções dos alunos">
      <FIELDS>
        <FIELD NAME="idcoleta" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" AUTO="true" SEQUENCE="true" COMMENT="ID da coleta" />
        <FIELD NAME="idaluno" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" COMMENT="ID do aluno" />
        <FIELD NAME="respostalikert" TYPE="int" LENGTH="10" NOTNULL="true" COMMENT="Resposta no formato Likert" />
        <FIELD NAME="idcadastrocoleta" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" COMMENT="ID do cadastro de coleta" />
        <FIELD NAME="idperguntaaeq" TYPE="int" LENGTH="10" NOTNULL="true" UNSIGNED="true" COMMENT="ID da pergunta AEQ" />
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="idcoleta" />
        <KEY NAME="fk_aluno" TYPE="foreign" FIELDS="idaluno" REFTABLE="aluno" REFFIELDS="idaluno" ONDELETE="cascade" />
        <KEY NAME="fk_cadastrocoleta" TYPE="foreign" FIELDS="idcadastrocoleta" REFTABLE="cadastrocoleta" REFFIELDS="idcadastrocoleta" ONDELETE="cascade" />
        <KEY NAME="fk_perguntaaeq" TYPE="foreign" FIELDS="idperguntaaeq" REFTABLE="perguntas_aeq" REFFIELDS="idperguntaaeq" ONDELETE="cascade" />
      </KEYS>
    </TABLE>

  </TABLES>
  
</XMLDB>
